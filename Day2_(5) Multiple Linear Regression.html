<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dohyo Jeong">
<meta name="dcterms.date" content="2024-08-13">

<title>EPPS Math Coding Camp</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Day2_(5) Multiple Linear Regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="Day2_(5) Multiple Linear Regression_files/libs/quarto-html/quarto.js"></script>
<script src="Day2_(5) Multiple Linear Regression_files/libs/quarto-html/popper.min.js"></script>
<script src="Day2_(5) Multiple Linear Regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Day2_(5) Multiple Linear Regression_files/libs/quarto-html/anchor.min.js"></script>
<link href="Day2_(5) Multiple Linear Regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Day2_(5) Multiple Linear Regression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Day2_(5) Multiple Linear Regression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Day2_(5) Multiple Linear Regression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Day2_(5) Multiple Linear Regression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#session-1-multiple-linear-regression" id="toc-session-1-multiple-linear-regression" class="nav-link active" data-scroll-target="#session-1-multiple-linear-regression">Session 1: Multiple Linear Regression</a>
  <ul class="collapse">
  <li><a href="#introduction-and-data-overview" id="toc-introduction-and-data-overview" class="nav-link" data-scroll-target="#introduction-and-data-overview">1.1 Introduction and Data Overview</a>
  <ul class="collapse">
  <li><a href="#dataset-boston-from-the-mass-package" id="toc-dataset-boston-from-the-mass-package" class="nav-link" data-scroll-target="#dataset-boston-from-the-mass-package">Dataset: Boston from the MASS Package</a></li>
  </ul></li>
  <li><a href="#extending-to-multiple-predictors" id="toc-extending-to-multiple-predictors" class="nav-link" data-scroll-target="#extending-to-multiple-predictors">1.2 Extending to Multiple Predictors</a>
  <ul class="collapse">
  <li><a href="#concept-and-purpose" id="toc-concept-and-purpose" class="nav-link" data-scroll-target="#concept-and-purpose">Concept and Purpose</a></li>
  </ul></li>
  <li><a href="#interpreting-coefficients-and-p-values" id="toc-interpreting-coefficients-and-p-values" class="nav-link" data-scroll-target="#interpreting-coefficients-and-p-values">1.3 Interpreting Coefficients and p-values</a>
  <ul class="collapse">
  <li><a href="#detailed-interpretation" id="toc-detailed-interpretation" class="nav-link" data-scroll-target="#detailed-interpretation">Detailed Interpretation</a></li>
  </ul></li>
  <li><a href="#stepwise-regression-and-model-selection" id="toc-stepwise-regression-and-model-selection" class="nav-link" data-scroll-target="#stepwise-regression-and-model-selection">1.4 Stepwise Regression and Model Selection</a>
  <ul class="collapse">
  <li><a href="#example-1-forward-selection" id="toc-example-1-forward-selection" class="nav-link" data-scroll-target="#example-1-forward-selection">Example 1: Forward Selection</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#session-2-hands-on-exercises" id="toc-session-2-hands-on-exercises" class="nav-link" data-scroll-target="#session-2-hands-on-exercises">Session 2: Hands-on Exercises</a>
  <ul class="collapse">
  <li><a href="#exercise-1-fitting-a-multiple-linear-regression-model" id="toc-exercise-1-fitting-a-multiple-linear-regression-model" class="nav-link" data-scroll-target="#exercise-1-fitting-a-multiple-linear-regression-model">Exercise 1: Fitting a Multiple Linear Regression Model</a></li>
  <li><a href="#exercise-2-refining-the-model-with-stepwise-regression" id="toc-exercise-2-refining-the-model-with-stepwise-regression" class="nav-link" data-scroll-target="#exercise-2-refining-the-model-with-stepwise-regression">Exercise 2: Refining the Model with Stepwise Regression</a></li>
  </ul></li>
  <li><a href="#session-3-wrapping-up-and-qa" id="toc-session-3-wrapping-up-and-qa" class="nav-link" data-scroll-target="#session-3-wrapping-up-and-qa">Session 3: Wrapping Up and Q&amp;A</a>
  <ul class="collapse">
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">EPPS Math Coding Camp</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Multiple Linear Regression</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dohyo Jeong </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 13, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="session-1-multiple-linear-regression" class="level1">
<h1>Session 1: Multiple Linear Regression</h1>
<section id="introduction-and-data-overview" class="level2">
<h2 class="anchored" data-anchor-id="introduction-and-data-overview">1.1 Introduction and Data Overview</h2>
<section id="what-is-multiple-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="what-is-multiple-linear-regression">What is Multiple Linear Regression?</h4>
<p>Multiple linear regression is an extension of simple linear regression in which the relationship between a single dependent variable and two or more independent variables is modeled. This approach helps capture the complexity of real-world data by considering multiple factors that could influence the outcome.</p>
</section>
<section id="dataset-boston-from-the-mass-package" class="level3">
<h3 class="anchored" data-anchor-id="dataset-boston-from-the-mass-package">Dataset: Boston from the MASS Package</h3>
<p>The Boston dataset from the MASS package provides information on housing in the Boston area, including socio-economic and environmental factors. It contains 506 observations on 14 variables.<br></p>
<p><strong>Key variables:</strong><br> - <strong>crim</strong>: Crime rate per capita by town.<br> - <strong>zn</strong>: Proportion of residential land zoned for large lots.<br> - <strong>indus</strong>: Proportion of non-retail business acres per town.<br> - <strong>chas</strong>: Charles River dummy variable (1 if tract bounds river; 0 otherwise).<br> - <strong>nox</strong>: Nitrogen oxides concentration.<br> - <strong>rm</strong>: Average number of rooms per dwelling.<br> - <strong>age</strong>: Proportion of owner-occupied units built before 1940.<br> - <strong>dis</strong>: Distances to Boston employment centers.<br> - <strong>rad</strong>: Index of accessibility to radial highways.<br> - <strong>tax</strong>: Property tax rate per $10,000.<br> - <strong>ptratio</strong>: Pupil-teacher ratio by town.<br> - <strong>black</strong>: 1000(Bk - 0.63)^2 where Bk is the proportion of Black residents by town.<br> - <strong>lstat</strong>: Percentage of lower status population.<br> - <strong>medv</strong>: Median value of owner-occupied homes in $1000s.<br> <br></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary packages and data</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("MASS")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Boston"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the dataset</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     crim zn indus chas   nox    rm  age    dis rad tax ptratio  black lstat
1 0.00632 18  2.31    0 0.538 6.575 65.2 4.0900   1 296    15.3 396.90  4.98
2 0.02731  0  7.07    0 0.469 6.421 78.9 4.9671   2 242    17.8 396.90  9.14
3 0.02729  0  7.07    0 0.469 7.185 61.1 4.9671   2 242    17.8 392.83  4.03
4 0.03237  0  2.18    0 0.458 6.998 45.8 6.0622   3 222    18.7 394.63  2.94
5 0.06905  0  2.18    0 0.458 7.147 54.2 6.0622   3 222    18.7 396.90  5.33
6 0.02985  0  2.18    0 0.458 6.430 58.7 6.0622   3 222    18.7 394.12  5.21
  medv
1 24.0
2 21.6
3 34.7
4 33.4
5 36.2
6 28.7</code></pre>
</div>
</div>
<p><br></p>
</section>
</section>
<section id="extending-to-multiple-predictors" class="level2">
<h2 class="anchored" data-anchor-id="extending-to-multiple-predictors">1.2 Extending to Multiple Predictors</h2>
<section id="concept-and-purpose" class="level3">
<h3 class="anchored" data-anchor-id="concept-and-purpose">Concept and Purpose</h3>
<p>In simple linear regression, we model the relationship between a dependent variable and one independent variable. However, in real-world scenarios, outcomes are often influenced by multiple factors. Multiple linear regression allows us to model the relationship between the dependent variable (in this case, medv) and multiple independent variables, providing a more comprehensive understanding of the factors affecting the outcome. <br></p>
<section id="example-fitting-a-multiple-linear-regression-model" class="level4">
<h4 class="anchored" data-anchor-id="example-fitting-a-multiple-linear-regression-model">Example: Fitting a Multiple Linear Regression Model</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple linear regression model</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>multi_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> age <span class="sc">+</span> dis <span class="sc">+</span> tax, <span class="at">data =</span> Boston)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ crim + rm + age + dis + tax, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.614  -2.911  -0.833   1.987  40.959 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.796901   3.236248  -3.645 0.000295 ***
crim         -0.140933   0.037531  -3.755 0.000194 ***
rm            7.731058   0.390879  19.779  &lt; 2e-16 ***
age          -0.079425   0.014272  -5.565 4.28e-08 ***
dis          -0.944654   0.194106  -4.867 1.52e-06 ***
tax          -0.011553   0.002144  -5.389 1.09e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.856 on 500 degrees of freedom
Multiple R-squared:  0.5986,    Adjusted R-squared:  0.5946 
F-statistic: 149.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="explanation" class="level4">
<h4 class="anchored" data-anchor-id="explanation">Explanation:</h4>
<p>The formula <strong>medv ~ crim + rm + age + dis + tax</strong> specifies the response variable (medv) and the predictor variables (crim, rm, age, dis, and tax).<br> <strong>lm()</strong> fits the multiple linear regression model, and <strong>summary()</strong> provides detailed output, including coefficients, R-squared, and p-values.<br></p>
</section>
<section id="interpreting-results" class="level4">
<h4 class="anchored" data-anchor-id="interpreting-results">Interpreting Results:</h4>
<ul>
<li><strong>Coefficients</strong>: Each coefficient represents the change in the dependent variable (medv) for a one-unit change in the corresponding independent variable, holding all other variables constant.<br> For example, if the coefficient for rm is positive, it indicates that an increase in the average number of rooms per dwelling is associated with an increase in the median home value. <br></li>
<li><strong>R-squared</strong>: This statistic measures the proportion of the variance in the dependent variable that is explained by the independent variables in the model. A higher R-squared indicates a better fit. <br></li>
<li><strong>p-values</strong>: These values test the null hypothesis that a given coefficient is equal to zero (i.e., the variable has no effect). A p-value less than 0.05 typically indicates that the variable is statistically significant. <br></li>
</ul>
</section>
</section>
</section>
<section id="interpreting-coefficients-and-p-values" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-coefficients-and-p-values">1.3 Interpreting Coefficients and p-values</h2>
<section id="detailed-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="detailed-interpretation">Detailed Interpretation</h3>
<p>Interpreting the coefficients and p-values in a multiple regression model is crucial for understanding the relationships between the variables. <br></p>
<section id="example-interpretation" class="level4">
<h4 class="anchored" data-anchor-id="example-interpretation">Example Interpretation:</h4>
<ul>
<li><strong>crim coefficient</strong>: Suppose the coefficient for crim (crime rate) is -0.2. This negative value suggests that, holding other factors constant, an increase in the crime rate by one unit is associated with a decrease in the median home value by $200 (since the dependent variable medv is in $1000s).</li>
<li><strong>rm coefficient</strong>: If the coefficient for rm is 5.0, it indicates that, on average, each additional room in a dwelling is associated with an increase in the median home value by $5000, holding other variables constant.</li>
<li><strong>age coefficient</strong>: A positive coefficient for age might suggest that older neighborhoods (with a higher proportion of homes built before 1940) are associated with higher median home values, assuming other factors are held constant.<br> <br></li>
</ul>
</section>
<section id="significance" class="level4">
<h4 class="anchored" data-anchor-id="significance">Significance:</h4>
<p><strong>p-value &lt; 0.05</strong>: A predictor with a p-value less than 0.05 is considered statistically significant, meaning there is strong evidence that the predictor is associated with the response variable.<br> <strong>Confidence Intervals</strong>: These provide a range of values within which the true coefficient is likely to fall, offering insight into the precision of the estimates. <br> <br></p>
</section>
</section>
</section>
<section id="stepwise-regression-and-model-selection" class="level2">
<h2 class="anchored" data-anchor-id="stepwise-regression-and-model-selection">1.4 Stepwise Regression and Model Selection</h2>
<section id="overview" class="level4">
<h4 class="anchored" data-anchor-id="overview">Overview</h4>
<p>Stepwise regression selects a subset of variables that contribute the most to predicting the dependent variable. It combines statistical techniques with automated procedures to add or remove predictors based on their significance and impact on model performance. <br></p>
<p><br></p>
</section>
<section id="example-1-forward-selection" class="level3">
<h3 class="anchored" data-anchor-id="example-1-forward-selection">Example 1: Forward Selection</h3>
<p>Forward selection begins with an empty model and adds predictors one at a time, selecting the predictor that improves the model the most at each step. <br></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("stats")</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection starting from an empty model</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>empty_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>forward_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">step</span>(empty_model, </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> empty_model, <span class="at">upper =</span> full_model),</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2246.51
medv ~ 1

          Df Sum of Sq   RSS    AIC
+ lstat    1   23243.9 19472 1851.0
+ rm       1   20654.4 22062 1914.2
+ ptratio  1   11014.3 31702 2097.6
+ indus    1    9995.2 32721 2113.6
+ tax      1    9377.3 33339 2123.1
+ nox      1    7800.1 34916 2146.5
+ crim     1    6440.8 36276 2165.8
+ rad      1    6221.1 36495 2168.9
+ age      1    6069.8 36647 2171.0
+ zn       1    5549.7 37167 2178.1
+ black    1    4749.9 37966 2188.9
+ dis      1    2668.2 40048 2215.9
+ chas     1    1312.1 41404 2232.7
&lt;none&gt;                 42716 2246.5

Step:  AIC=1851.01
medv ~ lstat

          Df Sum of Sq   RSS    AIC
+ rm       1    4033.1 15439 1735.6
+ ptratio  1    2670.1 16802 1778.4
+ chas     1     786.3 18686 1832.2
+ dis      1     772.4 18700 1832.5
+ age      1     304.3 19168 1845.0
+ tax      1     274.4 19198 1845.8
+ black    1     198.3 19274 1847.8
+ zn       1     160.3 19312 1848.8
+ crim     1     146.9 19325 1849.2
+ indus    1      98.7 19374 1850.4
&lt;none&gt;                 19472 1851.0
+ rad      1      25.1 19447 1852.4
+ nox      1       4.8 19468 1852.9

Step:  AIC=1735.58
medv ~ lstat + rm

          Df Sum of Sq   RSS    AIC
+ ptratio  1   1711.32 13728 1678.1
+ chas     1    548.53 14891 1719.3
+ black    1    512.31 14927 1720.5
+ tax      1    425.16 15014 1723.5
+ dis      1    351.15 15088 1725.9
+ crim     1    311.42 15128 1727.3
+ rad      1    180.45 15259 1731.6
+ indus    1     61.09 15378 1735.6
&lt;none&gt;                 15439 1735.6
+ zn       1     56.56 15383 1735.7
+ age      1     20.18 15419 1736.9
+ nox      1     14.90 15424 1737.1

Step:  AIC=1678.13
medv ~ lstat + rm + ptratio

        Df Sum of Sq   RSS    AIC
+ dis    1    499.08 13229 1661.4
+ black  1    389.68 13338 1665.6
+ chas   1    377.96 13350 1666.0
+ crim   1    122.52 13606 1675.6
+ age    1     66.24 13662 1677.7
&lt;none&gt;               13728 1678.1
+ tax    1     44.36 13684 1678.5
+ nox    1     24.81 13703 1679.2
+ zn     1     14.96 13713 1679.6
+ rad    1      6.07 13722 1679.9
+ indus  1      0.83 13727 1680.1

Step:  AIC=1661.39
medv ~ lstat + rm + ptratio + dis

        Df Sum of Sq   RSS    AIC
+ nox    1    759.56 12469 1633.5
+ black  1    502.64 12726 1643.8
+ chas   1    267.43 12962 1653.1
+ indus  1    242.65 12986 1654.0
+ tax    1    240.34 12989 1654.1
+ crim   1    233.54 12995 1654.4
+ zn     1    144.81 13084 1657.8
+ age    1     61.36 13168 1661.0
&lt;none&gt;               13229 1661.4
+ rad    1     22.40 13206 1662.5

Step:  AIC=1633.47
medv ~ lstat + rm + ptratio + dis + nox

        Df Sum of Sq   RSS    AIC
+ chas   1    328.27 12141 1622.0
+ black  1    311.83 12158 1622.7
+ zn     1    151.71 12318 1629.3
+ crim   1    141.43 12328 1629.7
+ rad    1     53.48 12416 1633.3
&lt;none&gt;               12469 1633.5
+ indus  1     17.10 12452 1634.8
+ tax    1     10.50 12459 1635.0
+ age    1      0.25 12469 1635.5

Step:  AIC=1621.97
medv ~ lstat + rm + ptratio + dis + nox + chas

        Df Sum of Sq   RSS    AIC
+ black  1   272.837 11868 1612.5
+ zn     1   164.406 11977 1617.1
+ crim   1   116.330 12025 1619.1
+ rad    1    58.556 12082 1621.5
&lt;none&gt;               12141 1622.0
+ indus  1    26.274 12115 1622.9
+ tax    1     4.187 12137 1623.8
+ age    1     2.331 12139 1623.9

Step:  AIC=1612.47
medv ~ lstat + rm + ptratio + dis + nox + chas + black

        Df Sum of Sq   RSS    AIC
+ zn     1   189.936 11678 1606.3
+ rad    1   144.320 11724 1608.3
+ crim   1    55.633 11813 1612.1
&lt;none&gt;               11868 1612.5
+ indus  1    15.584 11853 1613.8
+ age    1     9.446 11859 1614.1
+ tax    1     2.703 11866 1614.4

Step:  AIC=1606.31
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn

        Df Sum of Sq   RSS    AIC
+ crim   1    94.712 11584 1604.2
+ rad    1    93.614 11585 1604.2
&lt;none&gt;               11678 1606.3
+ indus  1    16.048 11662 1607.6
+ tax    1     3.952 11674 1608.1
+ age    1     1.491 11677 1608.2

Step:  AIC=1604.19
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    crim

        Df Sum of Sq   RSS    AIC
+ rad    1   228.604 11355 1596.1
&lt;none&gt;               11584 1604.2
+ indus  1    15.773 11568 1605.5
+ age    1     2.470 11581 1606.1
+ tax    1     1.305 11582 1606.1

Step:  AIC=1596.1
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    crim + rad

        Df Sum of Sq   RSS    AIC
+ tax    1   273.619 11081 1585.8
&lt;none&gt;               11355 1596.1
+ indus  1    33.894 11321 1596.6
+ age    1     0.096 11355 1598.1

Step:  AIC=1585.76
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    crim + rad + tax

        Df Sum of Sq   RSS    AIC
&lt;none&gt;               11081 1585.8
+ indus  1   2.51754 11079 1587.7
+ age    1   0.06271 11081 1587.8</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat + rm + ptratio + dis + nox + chas + 
    black + zn + crim + rad + tax, data = Boston)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5984  -2.7386  -0.5046   1.7273  26.2373 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  36.341145   5.067492   7.171 2.73e-12 ***
lstat        -0.522553   0.047424 -11.019  &lt; 2e-16 ***
rm            3.801579   0.406316   9.356  &lt; 2e-16 ***
ptratio      -0.946525   0.129066  -7.334 9.24e-13 ***
dis          -1.492711   0.185731  -8.037 6.84e-15 ***
nox         -17.376023   3.535243  -4.915 1.21e-06 ***
chas          2.718716   0.854240   3.183 0.001551 ** 
black         0.009291   0.002674   3.475 0.000557 ***
zn            0.045845   0.013523   3.390 0.000754 ***
crim         -0.108413   0.032779  -3.307 0.001010 ** 
rad           0.299608   0.063402   4.726 3.00e-06 ***
tax          -0.011778   0.003372  -3.493 0.000521 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.736 on 494 degrees of freedom
Multiple R-squared:  0.7406,    Adjusted R-squared:  0.7348 
F-statistic: 128.2 on 11 and 494 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br> - <strong>empty_model</strong>: This is the simplest model, containing only the intercept (no predictors). - The basic model starts with all predictors (<strong>lm(medv ~ .)</strong>).<br> - The <strong>scope</strong> argument defines the range of models to consider, from the simplest (intercept only) to the full model (all predictors).<br> - The <strong>step()</strong> function iteratively adds predictors that reduce the AIC, improving the model fit.<br> <br></p>
<section id="example-2-backward-elimination" class="level4">
<h4 class="anchored" data-anchor-id="example-2-backward-elimination">Example 2: Backward Elimination</h4>
<p>Backward elimination starts with the full model and removes the least significant predictors one by one, based on criteria like AIC.<br> <br></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward elimination starting from the full model</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">step</span>(full_model, <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1589.64
medv ~ crim + zn + indus + chas + nox + rm + age + dis + rad + 
    tax + ptratio + black + lstat

          Df Sum of Sq   RSS    AIC
- age      1      0.06 11079 1587.7
- indus    1      2.52 11081 1587.8
&lt;none&gt;                 11079 1589.6
- chas     1    218.97 11298 1597.5
- tax      1    242.26 11321 1598.6
- crim     1    243.22 11322 1598.6
- zn       1    257.49 11336 1599.3
- black    1    270.63 11349 1599.8
- rad      1    479.15 11558 1609.1
- nox      1    487.16 11566 1609.4
- ptratio  1   1194.23 12273 1639.4
- dis      1   1232.41 12311 1641.0
- rm       1   1871.32 12950 1666.6
- lstat    1   2410.84 13490 1687.3

Step:  AIC=1587.65
medv ~ crim + zn + indus + chas + nox + rm + dis + rad + tax + 
    ptratio + black + lstat

          Df Sum of Sq   RSS    AIC
- indus    1      2.52 11081 1585.8
&lt;none&gt;                 11079 1587.7
- chas     1    219.91 11299 1595.6
- tax      1    242.24 11321 1596.6
- crim     1    243.20 11322 1596.6
- zn       1    260.32 11339 1597.4
- black    1    272.26 11351 1597.9
- rad      1    481.09 11560 1607.2
- nox      1    520.87 11600 1608.9
- ptratio  1   1200.23 12279 1637.7
- dis      1   1352.26 12431 1643.9
- rm       1   1959.55 13038 1668.0
- lstat    1   2718.88 13798 1696.7

Step:  AIC=1585.76
medv ~ crim + zn + chas + nox + rm + dis + rad + tax + ptratio + 
    black + lstat

          Df Sum of Sq   RSS    AIC
&lt;none&gt;                 11081 1585.8
- chas     1    227.21 11309 1594.0
- crim     1    245.37 11327 1594.8
- zn       1    257.82 11339 1595.4
- black    1    270.82 11352 1596.0
- tax      1    273.62 11355 1596.1
- rad      1    500.92 11582 1606.1
- nox      1    541.91 11623 1607.9
- ptratio  1   1206.45 12288 1636.0
- dis      1   1448.94 12530 1645.9
- rm       1   1963.66 13045 1666.3
- lstat    1   2723.48 13805 1695.0</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ crim + zn + chas + nox + rm + dis + rad + 
    tax + ptratio + black + lstat, data = Boston)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5984  -2.7386  -0.5046   1.7273  26.2373 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  36.341145   5.067492   7.171 2.73e-12 ***
crim         -0.108413   0.032779  -3.307 0.001010 ** 
zn            0.045845   0.013523   3.390 0.000754 ***
chas          2.718716   0.854240   3.183 0.001551 ** 
nox         -17.376023   3.535243  -4.915 1.21e-06 ***
rm            3.801579   0.406316   9.356  &lt; 2e-16 ***
dis          -1.492711   0.185731  -8.037 6.84e-15 ***
rad           0.299608   0.063402   4.726 3.00e-06 ***
tax          -0.011778   0.003372  -3.493 0.000521 ***
ptratio      -0.946525   0.129066  -7.334 9.24e-13 ***
black         0.009291   0.002674   3.475 0.000557 ***
lstat        -0.522553   0.047424 -11.019  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.736 on 494 degrees of freedom
Multiple R-squared:  0.7406,    Adjusted R-squared:  0.7348 
F-statistic: 128.2 on 11 and 494 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="explanation-1" class="level4">
<h4 class="anchored" data-anchor-id="explanation-1">Explanation:</h4>
<p>The model starts with all predictors (<strong>lm(medv ~ .)</strong>).<br> The <strong>step()</strong> function removes predictors that contribute least to the model fit, as indicated by the highest AIC.<br> <br></p>
</section>
<section id="example-3-bidirectional-elimination" class="level4">
<h4 class="anchored" data-anchor-id="example-3-bidirectional-elimination">Example 3: Bidirectional Elimination</h4>
<p>Bidirectional elimination combines both forward selection and backward elimination, allowing variables to be added or removed based on their significance.<br> <br></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bidirectional elimination</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>empty_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>both_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">step</span>(empty_model, </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> empty_model, <span class="at">upper =</span> full_model), </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                          <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2246.51
medv ~ 1

          Df Sum of Sq   RSS    AIC
+ lstat    1   23243.9 19472 1851.0
+ rm       1   20654.4 22062 1914.2
+ ptratio  1   11014.3 31702 2097.6
+ indus    1    9995.2 32721 2113.6
+ tax      1    9377.3 33339 2123.1
+ nox      1    7800.1 34916 2146.5
+ crim     1    6440.8 36276 2165.8
+ rad      1    6221.1 36495 2168.9
+ age      1    6069.8 36647 2171.0
+ zn       1    5549.7 37167 2178.1
+ black    1    4749.9 37966 2188.9
+ dis      1    2668.2 40048 2215.9
+ chas     1    1312.1 41404 2232.7
&lt;none&gt;                 42716 2246.5

Step:  AIC=1851.01
medv ~ lstat

          Df Sum of Sq   RSS    AIC
+ rm       1    4033.1 15439 1735.6
+ ptratio  1    2670.1 16802 1778.4
+ chas     1     786.3 18686 1832.2
+ dis      1     772.4 18700 1832.5
+ age      1     304.3 19168 1845.0
+ tax      1     274.4 19198 1845.8
+ black    1     198.3 19274 1847.8
+ zn       1     160.3 19312 1848.8
+ crim     1     146.9 19325 1849.2
+ indus    1      98.7 19374 1850.4
&lt;none&gt;                 19472 1851.0
+ rad      1      25.1 19447 1852.4
+ nox      1       4.8 19468 1852.9
- lstat    1   23243.9 42716 2246.5

Step:  AIC=1735.58
medv ~ lstat + rm

          Df Sum of Sq   RSS    AIC
+ ptratio  1    1711.3 13728 1678.1
+ chas     1     548.5 14891 1719.3
+ black    1     512.3 14927 1720.5
+ tax      1     425.2 15014 1723.5
+ dis      1     351.2 15088 1725.9
+ crim     1     311.4 15128 1727.3
+ rad      1     180.5 15259 1731.6
+ indus    1      61.1 15378 1735.6
&lt;none&gt;                 15439 1735.6
+ zn       1      56.6 15383 1735.7
+ age      1      20.2 15419 1736.9
+ nox      1      14.9 15424 1737.1
- rm       1    4033.1 19472 1851.0
- lstat    1    6622.6 22062 1914.2

Step:  AIC=1678.13
medv ~ lstat + rm + ptratio

          Df Sum of Sq   RSS    AIC
+ dis      1     499.1 13229 1661.4
+ black    1     389.7 13338 1665.6
+ chas     1     378.0 13350 1666.0
+ crim     1     122.5 13606 1675.6
+ age      1      66.2 13662 1677.7
&lt;none&gt;                 13728 1678.1
+ tax      1      44.4 13684 1678.5
+ nox      1      24.8 13703 1679.2
+ zn       1      15.0 13713 1679.6
+ rad      1       6.1 13722 1679.9
+ indus    1       0.8 13727 1680.1
- ptratio  1    1711.3 15439 1735.6
- rm       1    3074.3 16802 1778.4
- lstat    1    5013.6 18742 1833.7

Step:  AIC=1661.39
medv ~ lstat + rm + ptratio + dis

          Df Sum of Sq   RSS    AIC
+ nox      1     759.6 12469 1633.5
+ black    1     502.6 12726 1643.8
+ chas     1     267.4 12962 1653.1
+ indus    1     242.6 12986 1654.0
+ tax      1     240.3 12989 1654.1
+ crim     1     233.5 12995 1654.4
+ zn       1     144.8 13084 1657.8
+ age      1      61.4 13168 1661.0
&lt;none&gt;                 13229 1661.4
+ rad      1      22.4 13206 1662.5
- dis      1     499.1 13728 1678.1
- ptratio  1    1859.3 15088 1725.9
- rm       1    2622.6 15852 1750.9
- lstat    1    5349.2 18578 1831.2

Step:  AIC=1633.47
medv ~ lstat + rm + ptratio + dis + nox

          Df Sum of Sq   RSS    AIC
+ chas     1     328.3 12141 1622.0
+ black    1     311.8 12158 1622.7
+ zn       1     151.7 12318 1629.3
+ crim     1     141.4 12328 1629.7
+ rad      1      53.5 12416 1633.3
&lt;none&gt;                 12469 1633.5
+ indus    1      17.1 12452 1634.8
+ tax      1      10.5 12459 1635.0
+ age      1       0.2 12469 1635.5
- nox      1     759.6 13229 1661.4
- dis      1    1233.8 13703 1679.2
- ptratio  1    2116.5 14586 1710.8
- rm       1    2546.2 15016 1725.5
- lstat    1    3664.3 16134 1761.8

Step:  AIC=1621.97
medv ~ lstat + rm + ptratio + dis + nox + chas

          Df Sum of Sq   RSS    AIC
+ black    1     272.8 11868 1612.5
+ zn       1     164.4 11977 1617.1
+ crim     1     116.3 12025 1619.1
+ rad      1      58.6 12082 1621.5
&lt;none&gt;                 12141 1622.0
+ indus    1      26.3 12115 1622.9
+ tax      1       4.2 12137 1623.8
+ age      1       2.3 12139 1623.9
- chas     1     328.3 12469 1633.5
- nox      1     820.4 12962 1653.1
- dis      1    1146.8 13288 1665.6
- ptratio  1    1924.9 14066 1694.4
- rm       1    2480.7 14622 1714.0
- lstat    1    3509.3 15650 1748.5

Step:  AIC=1612.47
medv ~ lstat + rm + ptratio + dis + nox + chas + black

          Df Sum of Sq   RSS    AIC
+ zn       1    189.94 11678 1606.3
+ rad      1    144.32 11724 1608.3
+ crim     1     55.63 11813 1612.1
&lt;none&gt;                 11868 1612.5
+ indus    1     15.58 11853 1613.8
+ age      1      9.45 11859 1614.1
+ tax      1      2.70 11866 1614.4
- black    1    272.84 12141 1622.0
- chas     1    289.27 12158 1622.7
- nox      1    626.85 12495 1636.5
- dis      1   1103.33 12972 1655.5
- ptratio  1   1804.30 13672 1682.1
- rm       1   2658.21 14526 1712.7
- lstat    1   2991.55 14860 1724.2

Step:  AIC=1606.31
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn

          Df Sum of Sq   RSS    AIC
+ crim     1     94.71 11584 1604.2
+ rad      1     93.61 11585 1604.2
&lt;none&gt;                 11678 1606.3
+ indus    1     16.05 11662 1607.6
+ tax      1      3.95 11674 1608.1
+ age      1      1.49 11677 1608.2
- zn       1    189.94 11868 1612.5
- black    1    298.37 11977 1617.1
- chas     1    300.42 11979 1617.2
- nox      1    627.62 12306 1630.8
- dis      1   1276.45 12955 1656.8
- ptratio  1   1364.63 13043 1660.2
- rm       1   2384.55 14063 1698.3
- lstat    1   3052.50 14731 1721.8

Step:  AIC=1604.19
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    crim

          Df Sum of Sq   RSS    AIC
+ rad      1    228.60 11355 1596.1
&lt;none&gt;                 11584 1604.2
+ indus    1     15.77 11568 1605.5
+ age      1      2.47 11581 1606.1
+ tax      1      1.31 11582 1606.1
- crim     1     94.71 11678 1606.3
- black    1    222.18 11806 1611.8
- zn       1    229.02 11813 1612.1
- chas     1    284.34 11868 1614.5
- nox      1    578.44 12162 1626.8
- ptratio  1   1192.90 12776 1651.8
- dis      1   1345.70 12929 1657.8
- rm       1   2419.57 14003 1698.2
- lstat    1   2753.42 14337 1710.1

Step:  AIC=1596.1
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    crim + rad

          Df Sum of Sq   RSS    AIC
+ tax      1    273.62 11081 1585.8
&lt;none&gt;                 11355 1596.1
+ indus    1     33.89 11321 1596.6
+ age      1      0.10 11355 1598.1
- zn       1    171.14 11526 1601.7
- rad      1    228.60 11584 1604.2
- crim     1    229.70 11585 1604.2
- chas     1    272.67 11628 1606.1
- black    1    295.78 11651 1607.1
- nox      1    785.16 12140 1627.9
- dis      1   1341.37 12696 1650.6
- ptratio  1   1419.77 12775 1653.7
- rm       1   2182.57 13538 1683.1
- lstat    1   2785.28 14140 1705.1

Step:  AIC=1585.76
medv ~ lstat + rm + ptratio + dis + nox + chas + black + zn + 
    crim + rad + tax

          Df Sum of Sq   RSS    AIC
&lt;none&gt;                 11081 1585.8
+ indus    1      2.52 11079 1587.7
+ age      1      0.06 11081 1587.8
- chas     1    227.21 11309 1594.0
- crim     1    245.37 11327 1594.8
- zn       1    257.82 11339 1595.4
- black    1    270.82 11352 1596.0
- tax      1    273.62 11355 1596.1
- rad      1    500.92 11582 1606.1
- nox      1    541.91 11623 1607.9
- ptratio  1   1206.45 12288 1636.0
- dis      1   1448.94 12530 1645.9
- rm       1   1963.66 13045 1666.3
- lstat    1   2723.48 13805 1695.0</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(both_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ lstat + rm + ptratio + dis + nox + chas + 
    black + zn + crim + rad + tax, data = Boston)

Residuals:
     Min       1Q   Median       3Q      Max 
-15.5984  -2.7386  -0.5046   1.7273  26.2373 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  36.341145   5.067492   7.171 2.73e-12 ***
lstat        -0.522553   0.047424 -11.019  &lt; 2e-16 ***
rm            3.801579   0.406316   9.356  &lt; 2e-16 ***
ptratio      -0.946525   0.129066  -7.334 9.24e-13 ***
dis          -1.492711   0.185731  -8.037 6.84e-15 ***
nox         -17.376023   3.535243  -4.915 1.21e-06 ***
chas          2.718716   0.854240   3.183 0.001551 ** 
black         0.009291   0.002674   3.475 0.000557 ***
zn            0.045845   0.013523   3.390 0.000754 ***
crim         -0.108413   0.032779  -3.307 0.001010 ** 
rad           0.299608   0.063402   4.726 3.00e-06 ***
tax          -0.011778   0.003372  -3.493 0.000521 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4.736 on 494 degrees of freedom
Multiple R-squared:  0.7406,    Adjusted R-squared:  0.7348 
F-statistic: 128.2 on 11 and 494 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="explanation-2" class="level4">
<h4 class="anchored" data-anchor-id="explanation-2">Explanation:</h4>
<p>This approach starts with either an empty model or a full model and considers adding or removing predictors based on the improvement in the criterion.<br> <br></p>
</section>
</section>
</section>
</section>
<section id="session-2-hands-on-exercises" class="level1">
<h1>Session 2: Hands-on Exercises</h1>
<ol type="1">
<li>Explore the Boston dataset and select one dependent variable (Y) and at least three independent variables (X1, X2, X3, …).</li>
<li>Use summary() and str() to explore the dataset and understand available variables. Choose a dependent variable (Y) that you think could be influenced by other factors in the dataset.</li>
<li>Select at least three independent variables (X1, X2, X3, etc.) that may impact the dependent variable.</li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary package and data</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Boston"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Think about the relationships between variables. For example, does the crime rate (crim) affect the median home value (medv)? Or could a house’s number of rooms (rm) predict home value?</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Consider using cor() to check the correlations between variables, which might help select predictors.</p>
</div>
</div>
<section id="solution" class="level4">
<h4 class="anchored" data-anchor-id="solution">Solution</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the dataset</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      crim                zn             indus            chas        
 Min.   : 0.00632   Min.   :  0.00   Min.   : 0.46   Min.   :0.00000  
 1st Qu.: 0.08205   1st Qu.:  0.00   1st Qu.: 5.19   1st Qu.:0.00000  
 Median : 0.25651   Median :  0.00   Median : 9.69   Median :0.00000  
 Mean   : 3.61352   Mean   : 11.36   Mean   :11.14   Mean   :0.06917  
 3rd Qu.: 3.67708   3rd Qu.: 12.50   3rd Qu.:18.10   3rd Qu.:0.00000  
 Max.   :88.97620   Max.   :100.00   Max.   :27.74   Max.   :1.00000  
      nox               rm             age              dis        
 Min.   :0.3850   Min.   :3.561   Min.   :  2.90   Min.   : 1.130  
 1st Qu.:0.4490   1st Qu.:5.886   1st Qu.: 45.02   1st Qu.: 2.100  
 Median :0.5380   Median :6.208   Median : 77.50   Median : 3.207  
 Mean   :0.5547   Mean   :6.285   Mean   : 68.57   Mean   : 3.795  
 3rd Qu.:0.6240   3rd Qu.:6.623   3rd Qu.: 94.08   3rd Qu.: 5.188  
 Max.   :0.8710   Max.   :8.780   Max.   :100.00   Max.   :12.127  
      rad              tax           ptratio          black       
 Min.   : 1.000   Min.   :187.0   Min.   :12.60   Min.   :  0.32  
 1st Qu.: 4.000   1st Qu.:279.0   1st Qu.:17.40   1st Qu.:375.38  
 Median : 5.000   Median :330.0   Median :19.05   Median :391.44  
 Mean   : 9.549   Mean   :408.2   Mean   :18.46   Mean   :356.67  
 3rd Qu.:24.000   3rd Qu.:666.0   3rd Qu.:20.20   3rd Qu.:396.23  
 Max.   :24.000   Max.   :711.0   Max.   :22.00   Max.   :396.90  
     lstat            medv      
 Min.   : 1.73   Min.   : 5.00  
 1st Qu.: 6.95   1st Qu.:17.02  
 Median :11.36   Median :21.20  
 Mean   :12.65   Mean   :22.53  
 3rd Qu.:16.95   3rd Qu.:25.00  
 Max.   :37.97   Max.   :50.00  </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Boston)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   506 obs. of  14 variables:
 $ crim   : num  0.00632 0.02731 0.02729 0.03237 0.06905 ...
 $ zn     : num  18 0 0 0 0 0 12.5 12.5 12.5 12.5 ...
 $ indus  : num  2.31 7.07 7.07 2.18 2.18 2.18 7.87 7.87 7.87 7.87 ...
 $ chas   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ nox    : num  0.538 0.469 0.469 0.458 0.458 0.458 0.524 0.524 0.524 0.524 ...
 $ rm     : num  6.58 6.42 7.18 7 7.15 ...
 $ age    : num  65.2 78.9 61.1 45.8 54.2 58.7 66.6 96.1 100 85.9 ...
 $ dis    : num  4.09 4.97 4.97 6.06 6.06 ...
 $ rad    : int  1 2 2 3 3 3 5 5 5 5 ...
 $ tax    : num  296 242 242 222 222 222 311 311 311 311 ...
 $ ptratio: num  15.3 17.8 17.8 18.7 18.7 18.7 15.2 15.2 15.2 15.2 ...
 $ black  : num  397 397 393 395 397 ...
 $ lstat  : num  4.98 9.14 4.03 2.94 5.33 ...
 $ medv   : num  24 21.6 34.7 33.4 36.2 28.7 22.9 27.1 16.5 18.9 ...</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example selection (students should choose their own):</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Dependent variable (Y): medv (Median value of owner-occupied homes)</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Independent variables (X): crim (crime rate), rm (average number of rooms), tax (property tax rate)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Check correlations (optional)</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Boston[<span class="fu">c</span>(<span class="st">"medv"</span>, <span class="st">"crim"</span>, <span class="st">"rm"</span>, <span class="st">"tax"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           medv       crim         rm        tax
medv  1.0000000 -0.3883046  0.6953599 -0.4685359
crim -0.3883046  1.0000000 -0.2192467  0.5827643
rm    0.6953599 -0.2192467  1.0000000 -0.2920478
tax  -0.4685359  0.5827643 -0.2920478  1.0000000</code></pre>
</div>
</div>
<p><br></p>
</section>
<section id="exercise-1-fitting-a-multiple-linear-regression-model" class="level3">
<h3 class="anchored" data-anchor-id="exercise-1-fitting-a-multiple-linear-regression-model">Exercise 1: Fitting a Multiple Linear Regression Model</h3>
<section id="q1" class="level4">
<h4 class="anchored" data-anchor-id="q1">Q1</h4>
<ol type="1">
<li>Use the lm() function to create a multiple linear regression model with your selected variables. <br></li>
<li>Display the summary of the model to interpret the coefficients, R-squared, and p-values. <br></li>
<li>For each independent variable, interpret the coefficient in terms of its impact on the dependent variable. <br></li>
</ol>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example based on a hypothetical selection (students should use their own selected variables):</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the multiple linear regression model</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax, <span class="at">data =</span> Boston)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ crim + rm + tax, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.322  -3.105  -0.680   2.327  41.081 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -21.798367   2.805644  -7.769 4.48e-14 ***
crim         -0.138675   0.038512  -3.601 0.000349 ***
rm            7.901643   0.400605  19.724  &lt; 2e-16 ***
tax          -0.011823   0.002005  -5.896 6.83e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.037 on 502 degrees of freedom
Multiple R-squared:  0.5716,    Adjusted R-squared:  0.5691 
F-statistic: 223.3 on 3 and 502 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="exercise-2-refining-the-model-with-stepwise-regression" class="level3">
<h3 class="anchored" data-anchor-id="exercise-2-refining-the-model-with-stepwise-regression">Exercise 2: Refining the Model with Stepwise Regression</h3>
<section id="q2" class="level4">
<h4 class="anchored" data-anchor-id="q2">Q2</h4>
<ol type="1">
<li>Apply forward selection, backward elimination, or bidirectional elimination to your model using the step() function. <br></li>
<li>Compare the new model with your initial model and discuss any differences in the selected variables and model performance. <br></li>
</ol>
</section>
<section id="solution-1" class="level4">
<h4 class="anchored" data-anchor-id="solution-1">Solution</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward Selection</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>forward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">upper =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> age <span class="sc">+</span> dis, <span class="at">data =</span> Boston)), </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2246.51
medv ~ 1

       Df Sum of Sq   RSS    AIC
+ rm    1   20654.4 22062 1914.2
+ tax   1    9377.3 33339 2123.1
+ crim  1    6440.8 36276 2165.8
+ age   1    6069.8 36647 2171.0
+ dis   1    2668.2 40048 2215.9
&lt;none&gt;              42716 2246.5

Step:  AIC=1914.19
medv ~ rm

       Df Sum of Sq   RSS    AIC
+ tax   1    3290.8 18771 1834.5
+ crim  1    2496.1 19566 1855.4
+ age   1    1997.0 20065 1868.2
+ dis   1     512.6 21549 1904.3
&lt;none&gt;              22062 1914.2

Step:  AIC=1834.45
medv ~ rm + tax

       Df Sum of Sq   RSS    AIC
+ crim  1    472.61 18299 1823.5
+ age   1    403.42 18368 1825.5
&lt;none&gt;              18771 1834.5
+ dis   1     55.81 18715 1834.9

Step:  AIC=1823.55
medv ~ rm + tax + crim

       Df Sum of Sq   RSS    AIC
+ age   1    341.95 17957 1816.0
+ dis   1     92.13 18206 1823.0
&lt;none&gt;              18299 1823.5

Step:  AIC=1816
medv ~ rm + tax + crim + age

       Df Sum of Sq   RSS    AIC
+ dis   1    812.12 17144 1794.6
&lt;none&gt;              17957 1816.0

Step:  AIC=1794.58
medv ~ rm + tax + crim + age + dis</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ rm + tax + crim + age + dis, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.614  -2.911  -0.833   1.987  40.959 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.796901   3.236248  -3.645 0.000295 ***
rm            7.731058   0.390879  19.779  &lt; 2e-16 ***
tax          -0.011553   0.002144  -5.389 1.09e-07 ***
crim         -0.140933   0.037531  -3.755 0.000194 ***
age          -0.079425   0.014272  -5.565 4.28e-08 ***
dis          -0.944654   0.194106  -4.867 1.52e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.856 on 500 degrees of freedom
Multiple R-squared:  0.5986,    Adjusted R-squared:  0.5946 
F-statistic: 149.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward Elimination</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> age <span class="sc">+</span> dis, <span class="at">data =</span> Boston), </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="st">"backward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=1794.58
medv ~ crim + rm + tax + age + dis

       Df Sum of Sq   RSS    AIC
&lt;none&gt;              17144 1794.6
- crim  1     483.5 17628 1806.7
- dis   1     812.1 17957 1816.0
- tax   1     995.9 18140 1821.2
- age   1    1061.9 18206 1823.0
- rm    1   13413.6 30558 2085.0</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ crim + rm + tax + age + dis, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.614  -2.911  -0.833   1.987  40.959 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.796901   3.236248  -3.645 0.000295 ***
crim         -0.140933   0.037531  -3.755 0.000194 ***
rm            7.731058   0.390879  19.779  &lt; 2e-16 ***
tax          -0.011553   0.002144  -5.389 1.09e-07 ***
age          -0.079425   0.014272  -5.565 4.28e-08 ***
dis          -0.944654   0.194106  -4.867 1.52e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.856 on 500 degrees of freedom
Multiple R-squared:  0.5986,    Adjusted R-squared:  0.5946 
F-statistic: 149.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bidirectional Elimination</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>both_model <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">upper =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> age <span class="sc">+</span> dis, <span class="at">data =</span> Boston)), </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=2246.51
medv ~ 1

       Df Sum of Sq   RSS    AIC
+ rm    1   20654.4 22062 1914.2
+ tax   1    9377.3 33339 2123.1
+ crim  1    6440.8 36276 2165.8
+ age   1    6069.8 36647 2171.0
+ dis   1    2668.2 40048 2215.9
&lt;none&gt;              42716 2246.5

Step:  AIC=1914.19
medv ~ rm

       Df Sum of Sq   RSS    AIC
+ tax   1    3290.8 18771 1834.5
+ crim  1    2496.1 19566 1855.4
+ age   1    1997.0 20065 1868.2
+ dis   1     512.6 21549 1904.3
&lt;none&gt;              22062 1914.2
- rm    1   20654.4 42716 2246.5

Step:  AIC=1834.45
medv ~ rm + tax

       Df Sum of Sq   RSS    AIC
+ crim  1     472.6 18298 1823.5
+ age   1     403.4 18368 1825.5
&lt;none&gt;              18771 1834.5
+ dis   1      55.8 18715 1834.9
- tax   1    3290.8 22062 1914.2
- rm    1   14567.9 33339 2123.1

Step:  AIC=1823.55
medv ~ rm + tax + crim

       Df Sum of Sq   RSS    AIC
+ age   1     341.9 17957 1816.0
+ dis   1      92.1 18206 1823.0
&lt;none&gt;              18298 1823.5
- crim  1     472.6 18771 1834.5
- tax   1    1267.3 19566 1855.4
- rm    1   14181.2 32480 2111.9

Step:  AIC=1816
medv ~ rm + tax + crim + age

       Df Sum of Sq   RSS    AIC
+ dis   1     812.1 17144 1794.6
&lt;none&gt;              17957 1816.0
- age   1     341.9 18299 1823.5
- crim  1     411.1 18368 1825.5
- tax   1     683.5 18640 1832.9
- rm    1   13551.4 31508 2098.5

Step:  AIC=1794.58
medv ~ rm + tax + crim + age + dis

       Df Sum of Sq   RSS    AIC
&lt;none&gt;              17144 1794.6
- crim  1     483.5 17628 1806.7
- dis   1     812.1 17957 1816.0
- tax   1     995.9 18140 1821.2
- age   1    1061.9 18206 1823.0
- rm    1   13413.6 30558 2085.0</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(both_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = medv ~ rm + tax + crim + age + dis, data = Boston)

Residuals:
    Min      1Q  Median      3Q     Max 
-17.614  -2.911  -0.833   1.987  40.959 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -11.796901   3.236248  -3.645 0.000295 ***
rm            7.731058   0.390879  19.779  &lt; 2e-16 ***
tax          -0.011553   0.002144  -5.389 1.09e-07 ***
crim         -0.140933   0.037531  -3.755 0.000194 ***
age          -0.079425   0.014272  -5.565 4.28e-08 ***
dis          -0.944654   0.194106  -4.867 1.52e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.856 on 500 degrees of freedom
Multiple R-squared:  0.5986,    Adjusted R-squared:  0.5946 
F-statistic: 149.2 on 5 and 500 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="session-3-wrapping-up-and-qa" class="level1">
<h1>Session 3: Wrapping Up and Q&amp;A</h1>
<p>In this session, we’ve covered multiple linear regression, extending to multiple predictors, interpreting coefficients and p-values, and using stepwise regression for model selection. These techniques are fundamental for building predictive models and understanding complex relationships in data. <br></p>
<p>Practice these methods with different datasets and variables to better understand and improve your analytical skills. <br> <br></p>
<p><strong>Q&amp;A</strong>: Please share any questions or challenges encountered during the exercises. Let’s discuss solutions and clarify concepts! <br></p>
<section id="reference" class="level3">
<h3 class="anchored" data-anchor-id="reference">Reference</h3>
<ul>
<li>https://datageneration.io/dataprogrammingwithr/intro</li>
<li>Chicago Harris School Coding Camp</li>
<li>Data.gov, the U.S. government’s open data portal</li>
<li>https://cran.r-project.org/web/packages/MASS/MASS.pdf</li>
<li>https://rdrr.io/cran/ISLR/man/Wage.html</li>
</ul>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb38" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "EPPS Math Coding Camp"</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Multiple Linear Regression"</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Dohyo Jeong"</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "August 13, 2024"</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">    highlight-style: github</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(echo = TRUE)</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session 1: Multiple Linear Regression</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.1 Introduction and Data Overview</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="fu">#### What is Multiple Linear Regression?</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a>Multiple linear regression is an extension of simple linear regression in which the relationship between a single dependent variable and two or more independent variables is modeled. This approach helps capture the complexity of real-world data by considering multiple factors that could influence the outcome.</span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dataset: Boston from the MASS Package</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a>The Boston dataset from the MASS package provides information on housing in the Boston area, including socio-economic and environmental factors. It contains 506 observations on 14 variables.&lt;br&gt;</span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a>**Key variables:**&lt;br&gt;</span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**crim**: Crime rate per capita by town.&lt;br&gt;</span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**zn**: Proportion of residential land zoned for large lots.&lt;br&gt;</span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**indus**: Proportion of non-retail business acres per town.&lt;br&gt;</span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**chas**: Charles River dummy variable (1 if tract bounds river; 0 otherwise).&lt;br&gt;</span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**nox**: Nitrogen oxides concentration.&lt;br&gt;</span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**rm**: Average number of rooms per dwelling.&lt;br&gt;</span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**age**: Proportion of owner-occupied units built before 1940.&lt;br&gt;</span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**dis**: Distances to Boston employment centers.&lt;br&gt;</span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**rad**: Index of accessibility to radial highways.&lt;br&gt;</span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**tax**: Property tax rate per $10,000.&lt;br&gt;</span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**ptratio**: Pupil-teacher ratio by town.&lt;br&gt;</span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**black**: 1000(Bk - 0.63)^2 where Bk is the proportion of Black residents by town.&lt;br&gt;</span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**lstat**: Percentage of lower status population.&lt;br&gt;</span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**medv**: Median value of owner-occupied homes in $1000s.&lt;br&gt;</span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary packages and data</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("MASS")</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Boston"</span>)</span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the dataset</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Boston)</span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.2 Extending to Multiple Predictors</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a><span class="fu">### Concept and Purpose</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a>In simple linear regression, we model the relationship between a dependent variable and one independent variable. However, in real-world scenarios, outcomes are often influenced by multiple factors. Multiple linear regression allows us to model the relationship between the dependent variable (in this case, medv) and multiple independent variables, providing a more comprehensive understanding of the factors affecting the outcome.</span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Fitting a Multiple Linear Regression Model</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiple linear regression model</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a>multi_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> age <span class="sc">+</span> dis <span class="sc">+</span> tax, <span class="at">data =</span> Boston)</span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the model</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(multi_lm)</span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Explanation:</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a>The formula **medv ~ crim + rm + age + dis + tax** specifies the response variable (medv) and the predictor variables (crim, rm, age, dis, and tax).&lt;br&gt;</span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a>**lm()** fits the multiple linear regression model, and **summary()** provides detailed output, including coefficients, R-squared, and p-values.&lt;br&gt;</span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interpreting Results:</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Coefficients**: Each coefficient represents the change in the dependent variable (medv) for a one-unit change in the corresponding independent variable, holding all other variables constant.&lt;br&gt;</span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a>  For example, if the coefficient for rm is positive, it indicates that an increase in the average number of rooms per dwelling is associated with an increase in the median home value. &lt;br&gt;</span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**R-squared**: This statistic measures the proportion of the variance in the dependent variable that is explained by the independent variables in the model. A higher R-squared indicates a better fit. &lt;br&gt;</span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**p-values**: These values test the null hypothesis that a given coefficient is equal to zero (i.e., the variable has no effect). A p-value less than 0.05 typically indicates that the variable is statistically significant.</span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.3 Interpreting Coefficients and p-values</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a><span class="fu">### Detailed Interpretation</span></span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a>Interpreting the coefficients and p-values in a multiple regression model is crucial for understanding the relationships between the variables. &lt;br&gt;</span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example Interpretation:</span></span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**crim coefficient**: Suppose the coefficient for crim (crime rate) is -0.2. This negative value suggests that, holding other factors constant, an increase in the crime rate by one unit is associated with a decrease in the median home value by $200 (since the dependent variable medv is in $1000s).</span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**rm coefficient**: If the coefficient for rm is 5.0, it indicates that, on average, each additional room in a dwelling is associated with an increase in the median home value by $5000, holding other variables constant.</span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**age coefficient**: A positive coefficient for age might suggest that older neighborhoods (with a higher proportion of homes built before 1940) are associated with higher median home values, assuming other factors are held constant.&lt;br&gt;</span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Significance:</span></span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a>**p-value &lt; 0.05**: A predictor with a p-value less than 0.05 is considered statistically significant, meaning there is strong evidence that the predictor is associated with the response variable.&lt;br&gt;</span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a>**Confidence Intervals**: These provide a range of values within which the true coefficient is likely to fall, offering insight into the precision of the estimates. &lt;br&gt;</span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1.4 Stepwise Regression and Model Selection</span></span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Overview</span></span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a>Stepwise regression selects a subset of variables that contribute the most to predicting the dependent variable. It combines statistical techniques with automated procedures to add or remove predictors based on their significance and impact on model performance. &lt;br&gt;</span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 1: Forward Selection</span></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a>Forward selection begins with an empty model and adds predictors one at a time, selecting the predictor that improves the model the most at each step. &lt;br&gt;</span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("stats")</span></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward selection starting from an empty model</span></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a>empty_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston)</span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a>forward_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">step</span>(empty_model, </span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a>                             <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> empty_model, <span class="at">upper =</span> full_model),</span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">"forward"</span>)</span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_model)</span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**empty_model**: This is the simplest model, containing only the intercept (no predictors).</span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The basic model starts with all predictors (**lm(medv ~ .)**).&lt;br&gt;</span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **scope** argument defines the range of models to consider, from the simplest (intercept only) to the full model (all predictors).&lt;br&gt;</span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The **step()** function iteratively adds predictors that reduce the AIC, improving the model fit.&lt;br&gt;</span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 2: Backward Elimination</span></span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a>Backward elimination starts with the full model and removes the least significant predictors one by one, based on criteria like AIC.&lt;br&gt;</span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward elimination starting from the full model</span></span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">step</span>(full_model, <span class="at">direction =</span> <span class="st">"backward"</span>)</span>
<span id="cb38-146"><a href="#cb38-146" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_model)</span>
<span id="cb38-147"><a href="#cb38-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-149"><a href="#cb38-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-150"><a href="#cb38-150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Explanation:</span></span>
<span id="cb38-151"><a href="#cb38-151" aria-hidden="true" tabindex="-1"></a>The model starts with all predictors (**lm(medv ~ .)**).&lt;br&gt;</span>
<span id="cb38-152"><a href="#cb38-152" aria-hidden="true" tabindex="-1"></a>The **step()** function removes predictors that contribute least to the model fit, as indicated by the highest AIC.&lt;br&gt;</span>
<span id="cb38-153"><a href="#cb38-153" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-154"><a href="#cb38-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-155"><a href="#cb38-155" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 3: Bidirectional Elimination</span></span>
<span id="cb38-156"><a href="#cb38-156" aria-hidden="true" tabindex="-1"></a>Bidirectional elimination combines both forward selection and backward elimination, allowing variables to be added or removed based on their significance.&lt;br&gt;</span>
<span id="cb38-157"><a href="#cb38-157" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-158"><a href="#cb38-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-161"><a href="#cb38-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-162"><a href="#cb38-162" aria-hidden="true" tabindex="-1"></a><span class="co"># Bidirectional elimination</span></span>
<span id="cb38-163"><a href="#cb38-163" aria-hidden="true" tabindex="-1"></a>empty_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston)</span>
<span id="cb38-164"><a href="#cb38-164" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> ., <span class="at">data =</span> Boston)</span>
<span id="cb38-165"><a href="#cb38-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-166"><a href="#cb38-166" aria-hidden="true" tabindex="-1"></a>both_model <span class="ot">&lt;-</span> stats<span class="sc">::</span><span class="fu">step</span>(empty_model, </span>
<span id="cb38-167"><a href="#cb38-167" aria-hidden="true" tabindex="-1"></a>                          <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> empty_model, <span class="at">upper =</span> full_model), </span>
<span id="cb38-168"><a href="#cb38-168" aria-hidden="true" tabindex="-1"></a>                          <span class="at">direction =</span> <span class="st">"both"</span>)</span>
<span id="cb38-169"><a href="#cb38-169" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(both_model)</span>
<span id="cb38-170"><a href="#cb38-170" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-171"><a href="#cb38-171" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-172"><a href="#cb38-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-173"><a href="#cb38-173" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Explanation:</span></span>
<span id="cb38-174"><a href="#cb38-174" aria-hidden="true" tabindex="-1"></a>This approach starts with either an empty model or a full model and considers adding or removing predictors based on the improvement in the criterion.&lt;br&gt;</span>
<span id="cb38-175"><a href="#cb38-175" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-176"><a href="#cb38-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-177"><a href="#cb38-177" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session 2: Hands-on Exercises</span></span>
<span id="cb38-178"><a href="#cb38-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-179"><a href="#cb38-179" aria-hidden="true" tabindex="-1"></a>1) Explore the Boston dataset and select one dependent variable (Y) and at least three independent variables (X1, X2, X3, ...).</span>
<span id="cb38-180"><a href="#cb38-180" aria-hidden="true" tabindex="-1"></a>2) Use summary() and str() to explore the dataset and understand available variables.</span>
<span id="cb38-181"><a href="#cb38-181" aria-hidden="true" tabindex="-1"></a>Choose a dependent variable (Y) that you think could be influenced by other factors in the dataset.</span>
<span id="cb38-182"><a href="#cb38-182" aria-hidden="true" tabindex="-1"></a>3) Select at least three independent variables (X1, X2, X3, etc.) that may impact the dependent variable.</span>
<span id="cb38-183"><a href="#cb38-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-184"><a href="#cb38-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-187"><a href="#cb38-187" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-188"><a href="#cb38-188" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary package and data</span></span>
<span id="cb38-189"><a href="#cb38-189" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb38-190"><a href="#cb38-190" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"Boston"</span>)</span>
<span id="cb38-191"><a href="#cb38-191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-192"><a href="#cb38-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-193"><a href="#cb38-193" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb38-194"><a href="#cb38-194" aria-hidden="true" tabindex="-1"></a>Think about the relationships between variables. For example, does the crime rate (crim) affect the median home value (medv)? Or could a house's number of rooms (rm) predict home value?</span>
<span id="cb38-195"><a href="#cb38-195" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-196"><a href="#cb38-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-197"><a href="#cb38-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-198"><a href="#cb38-198" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb38-199"><a href="#cb38-199" aria-hidden="true" tabindex="-1"></a>Consider using cor() to check the correlations between variables, which might help select predictors.</span>
<span id="cb38-200"><a href="#cb38-200" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb38-201"><a href="#cb38-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-202"><a href="#cb38-202" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Solution</span></span>
<span id="cb38-205"><a href="#cb38-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-206"><a href="#cb38-206" aria-hidden="true" tabindex="-1"></a><span class="co"># Exploring the dataset</span></span>
<span id="cb38-207"><a href="#cb38-207" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Boston)</span>
<span id="cb38-208"><a href="#cb38-208" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Boston)</span>
<span id="cb38-209"><a href="#cb38-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-210"><a href="#cb38-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Example selection (students should choose their own):</span></span>
<span id="cb38-211"><a href="#cb38-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Dependent variable (Y): medv (Median value of owner-occupied homes)</span></span>
<span id="cb38-212"><a href="#cb38-212" aria-hidden="true" tabindex="-1"></a><span class="co"># Independent variables (X): crim (crime rate), rm (average number of rooms), tax (property tax rate)</span></span>
<span id="cb38-213"><a href="#cb38-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-214"><a href="#cb38-214" aria-hidden="true" tabindex="-1"></a><span class="co"># Check correlations (optional)</span></span>
<span id="cb38-215"><a href="#cb38-215" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(Boston[<span class="fu">c</span>(<span class="st">"medv"</span>, <span class="st">"crim"</span>, <span class="st">"rm"</span>, <span class="st">"tax"</span>)])</span>
<span id="cb38-216"><a href="#cb38-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-217"><a href="#cb38-217" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-218"><a href="#cb38-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-219"><a href="#cb38-219" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 1: Fitting a Multiple Linear Regression Model</span></span>
<span id="cb38-220"><a href="#cb38-220" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Q1</span></span>
<span id="cb38-221"><a href="#cb38-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-222"><a href="#cb38-222" aria-hidden="true" tabindex="-1"></a>1) Use the lm() function to create a multiple linear regression model with your selected variables. &lt;br&gt;</span>
<span id="cb38-223"><a href="#cb38-223" aria-hidden="true" tabindex="-1"></a>2) Display the summary of the model to interpret the coefficients, R-squared, and p-values. &lt;br&gt;</span>
<span id="cb38-224"><a href="#cb38-224" aria-hidden="true" tabindex="-1"></a>3) For each independent variable, interpret the coefficient in terms of its impact on the dependent variable. &lt;br&gt;</span>
<span id="cb38-225"><a href="#cb38-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-228"><a href="#cb38-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-229"><a href="#cb38-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Example based on a hypothetical selection (students should use their own selected variables):</span></span>
<span id="cb38-230"><a href="#cb38-230" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting the multiple linear regression model</span></span>
<span id="cb38-231"><a href="#cb38-231" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax, <span class="at">data =</span> Boston)</span>
<span id="cb38-232"><a href="#cb38-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-233"><a href="#cb38-233" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the model summary</span></span>
<span id="cb38-234"><a href="#cb38-234" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span>
<span id="cb38-235"><a href="#cb38-235" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-236"><a href="#cb38-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-237"><a href="#cb38-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-238"><a href="#cb38-238" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exercise 2: Refining the Model with Stepwise Regression</span></span>
<span id="cb38-239"><a href="#cb38-239" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Q2</span></span>
<span id="cb38-240"><a href="#cb38-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-241"><a href="#cb38-241" aria-hidden="true" tabindex="-1"></a>1) Apply forward selection, backward elimination, or bidirectional elimination to your model using the step() function. &lt;br&gt;</span>
<span id="cb38-242"><a href="#cb38-242" aria-hidden="true" tabindex="-1"></a>2) Compare the new model with your initial model and discuss any differences in the selected variables and model performance. &lt;br&gt;</span>
<span id="cb38-243"><a href="#cb38-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-244"><a href="#cb38-244" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Solution</span></span>
<span id="cb38-247"><a href="#cb38-247" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb38-248"><a href="#cb38-248" aria-hidden="true" tabindex="-1"></a><span class="co"># Forward Selection</span></span>
<span id="cb38-249"><a href="#cb38-249" aria-hidden="true" tabindex="-1"></a>forward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb38-250"><a href="#cb38-250" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb38-251"><a href="#cb38-251" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">upper =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> age <span class="sc">+</span> dis, <span class="at">data =</span> Boston)), </span>
<span id="cb38-252"><a href="#cb38-252" aria-hidden="true" tabindex="-1"></a>                      <span class="at">direction =</span> <span class="st">"forward"</span>)</span>
<span id="cb38-253"><a href="#cb38-253" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(forward_model)</span>
<span id="cb38-254"><a href="#cb38-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-255"><a href="#cb38-255" aria-hidden="true" tabindex="-1"></a><span class="co"># Backward Elimination</span></span>
<span id="cb38-256"><a href="#cb38-256" aria-hidden="true" tabindex="-1"></a>backward_model <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> age <span class="sc">+</span> dis, <span class="at">data =</span> Boston), </span>
<span id="cb38-257"><a href="#cb38-257" aria-hidden="true" tabindex="-1"></a>                       <span class="at">direction =</span> <span class="st">"backward"</span>)</span>
<span id="cb38-258"><a href="#cb38-258" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(backward_model)</span>
<span id="cb38-259"><a href="#cb38-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-260"><a href="#cb38-260" aria-hidden="true" tabindex="-1"></a><span class="co"># Bidirectional Elimination</span></span>
<span id="cb38-261"><a href="#cb38-261" aria-hidden="true" tabindex="-1"></a>both_model <span class="ot">&lt;-</span> <span class="fu">step</span>(<span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb38-262"><a href="#cb38-262" aria-hidden="true" tabindex="-1"></a>                   <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> Boston), </span>
<span id="cb38-263"><a href="#cb38-263" aria-hidden="true" tabindex="-1"></a>                                <span class="at">upper =</span> <span class="fu">lm</span>(medv <span class="sc">~</span> crim <span class="sc">+</span> rm <span class="sc">+</span> tax <span class="sc">+</span> age <span class="sc">+</span> dis, <span class="at">data =</span> Boston)), </span>
<span id="cb38-264"><a href="#cb38-264" aria-hidden="true" tabindex="-1"></a>                   <span class="at">direction =</span> <span class="st">"both"</span>)</span>
<span id="cb38-265"><a href="#cb38-265" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(both_model)</span>
<span id="cb38-266"><a href="#cb38-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb38-267"><a href="#cb38-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-268"><a href="#cb38-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-269"><a href="#cb38-269" aria-hidden="true" tabindex="-1"></a><span class="fu"># Session 3: Wrapping Up and Q&amp;A</span></span>
<span id="cb38-270"><a href="#cb38-270" aria-hidden="true" tabindex="-1"></a>In this session, we've covered multiple linear regression, extending to multiple predictors, interpreting coefficients and p-values, and using stepwise regression for model selection. These techniques are fundamental for building predictive models and understanding complex relationships in data.</span>
<span id="cb38-271"><a href="#cb38-271" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-272"><a href="#cb38-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-273"><a href="#cb38-273" aria-hidden="true" tabindex="-1"></a>Practice these methods with different datasets and variables to better understand and improve your analytical skills. &lt;br&gt;</span>
<span id="cb38-274"><a href="#cb38-274" aria-hidden="true" tabindex="-1"></a>&lt;br&gt;</span>
<span id="cb38-275"><a href="#cb38-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-276"><a href="#cb38-276" aria-hidden="true" tabindex="-1"></a>**Q&amp;A**: Please share any questions or challenges encountered during the exercises. Let's discuss solutions and clarify concepts! &lt;br&gt;</span>
<span id="cb38-277"><a href="#cb38-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-278"><a href="#cb38-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-279"><a href="#cb38-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reference</span></span>
<span id="cb38-280"><a href="#cb38-280" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>https://datageneration.io/dataprogrammingwithr/intro</span>
<span id="cb38-281"><a href="#cb38-281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Chicago Harris School Coding Camp</span>
<span id="cb38-282"><a href="#cb38-282" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Data.gov, the U.S. government's open data portal</span>
<span id="cb38-283"><a href="#cb38-283" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>https://cran.r-project.org/web/packages/MASS/MASS.pdf</span>
<span id="cb38-284"><a href="#cb38-284" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>https://rdrr.io/cran/ISLR/man/Wage.html</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>